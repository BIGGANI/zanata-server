<html xmlns:c="http://www.concordion.org/2007/concordion"
  xmlns:ext="urn:concordion-extensions:2010">
<head>
  <title>User Administration</title>
</head>
<body>
<h1>Management of Search Indexes</h1>
<br/>

<h2>Running a full re-index</h2>

<p>
  As an Administrator, I want to completely regenerate search indexes.
</p>

<p>To regenerate search indexes, navigate to the Search Management page by

   <span c:execute="#managesearchpage = goToSearchAdministration()">
     <ol>
       <li>Opening the side menu and selecting 'Administration'</li>
       <li>Selecting 'Manage Search'</li>
     </ol>
   </span>
  <div ext:screenshot=""/>
</p>

<p>
  Select all tables to reindex by
  <span c:execute="#managesearchpage = clickSelectAll(#managesearchpage)">
    Clicking 'Select All'
  </span>, then
  <span c:assertTrue="allActionsSelected(#managesearchpage)">all actions should appear selected</span>.
  <div ext:screenshot=""/>
</p>

<p>
  Note that <span c:assertTrue="noOperationsRunning(#managesearchpage)">a message
  shows that no operations are running</span>.
</p>
<p>Run the reindex by:
  <ol>
    <li c:execute="#managesearchpage = performSelectedActions(#managesearchpage)">
      Clicking 'Perform Selected Actions'
    </li>
    <li c:execute="#managesearchpage = waitForActionsToFinish(#managesearchpage)">
      Waiting for the actions to finish
    </li>
  </ol>

  then
  <span c:assertTrue="showsCompleted(#managesearchpage)">
    a message shows that the operation is complete
  </span>
  , and
  <span c:assertTrue="noOperationsRunning(#managesearchpage)">
    another message shows that no operations are running
  </span>.
  <div ext:screenshot=""/>
</p>


<!-- This fails since the reindex completes too fast for the abort button to be pressed
TODO damason add sufficient test data to slow the reindex -->
<!--
<p>

  Abort a reindex after it is started by
  <ol>
    <li>
      <span c:execute="#managesearchpage = clickSelectAll(#managesearchpage)">
        Clicking 'Select All'
      </span>
    </li>
    <li>
      <span c:execute="#managesearchpage = performSelectedActions(#managesearchpage)">
        Clicking 'Perform Selected Actions'
      </span>
    </li>
    <li>
      <span c:execute="#managesearchpage = abortActions(#managesearchpage)">
        Immediately clicking 'Abort'
      </span>
    </li>
  </ol>

  then
  <span c:assertTrue="noOperationsRunning(#managesearchpage)">
    the display shows that no operations are running
  </span>
  and
  <span c:assertTrue="showsAborted(#managesearchpage)">
    the display shows that the actions were canceled
  </span>

  <div ext:screenshot=""/>
</p>
 -->

<!-- TODO clear selection, make sure checkboxes are unchecked -->
<!-- TODO also check that a newly opened tab shows the correct progress. -->


</body>
</html>
