<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
  xmlns:s="http://jboss.org/schema/seam/taglib"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:rich="http://richfaces.org/rich"
  template="../WEB-INF/template/template.xhtml">

<ui:define name="page_title">#{messages['jsf.PageTitle']}</ui:define>
<ui:define name="center_content">

<script type="text/javascript">
  jQuery(function(){

    crossroads.addRoute(':pre*:/dashboard/settings/{subSection}', function(pre, subSection) {
      onTabClick(jQuery('#settings'))
      zanata.tabs.activate(jQuery('#' + subSection + '-tab'))
    });

    crossroads.addRoute(':pre*:/dashboard/:section:', function(pre, section) {
      section = section || 'activity'
      onTabClick(jQuery('#' + section));
    });

    updateStateFromUrl();
  })
</script>

<s:fragment rendered="#{identity.loggedIn}">
  <div class="g">
    <div class="g__item w--1-m w--3-8-l w--1-3 l--push-bottom-half">
      <p class="txt--meta l--push-all-0">#{messages['jsf.Dashboard']}</p>

      <div class="g--loose">
      <s:div id="profile-overview" styleClass="g__item w--1-2-m">
        <div class="media l--push-bottom-half">
          <div class="media__item--right bx--round">
            <img
              src="#{dashboardAction.getUserImageUrl()}"
              alt="#{dashboardAction.getUsername()}"/>
          </div>
          <div class="media__body">
            <h1 class="l--push-all-0">#{dashboardAction.getUserFullName()}</h1>
            <ul class="list--no-bullets txt--meta">
              <li><i class="i i--user list__icon" title="Username"></i>#{dashboardAction.getUsername()}
              </li>
              <li><i class="i i--language list__icon"
                title="Spoken languages"></i>#{dashboardAction.getUserLanguageTeams()}
              </li>
            </ul>
          </div>
        </div>
      </s:div>
      <div class="g__item w--1-2-m">
        <div class="tabs--lined">
          <nav class="tabs__nav">
            <ul>
              <li><a href="javascript:void(0);" id="activity-today" class="js-tab is-active">#{messages['jsf.activity.today.label']}</a></li>
              <li><a href="javascript:void(0);" id="activity-week" class="js-tab">#{messages['jsf.activity.week.label']}</a></li>
              <li><a href="javascript:void(0);" id="activity-month" class="js-tab">#{messages['jsf.activity.month.label']}</a></li>
            </ul>
          </nav>
          <div class="tabs__content l--pad-h-half l--pad-top-1">
            <div id="activity-today_content">
              <ui:include src="../WEB-INF/layout/dashboard/stats.xhtml">
                <ui:param name="userStats" value="#{dashboardAction.getTodayStats()}"/>
              </ui:include>
            </div>
            <div id="activity-week_content" class="is-hidden">
              <ui:include src="../WEB-INF/layout/dashboard/stats.xhtml">
                <ui:param name="userStats" value="#{dashboardAction.getWeekStats()}"/>
              </ui:include>
            </div>
            <div id="activity-month_content" class="is-hidden">
              <ui:include src="../WEB-INF/layout/dashboard/stats.xhtml">
                <ui:param name="userStats" value="#{dashboardAction.getMonthStats()}"/>
              </ui:include>
            </div>
          </div>
        </div>
      </div>
    </div>
    </div>
    <div class="g__item w--1-m w--5-8-l w--2-3">
      <div class="tabs--lined">
      <nav class="tabs__nav">
        <ul>
          <li>
            <a id="activity"
              href="#{request.contextPath}/dashboard/activity"
              class="js-tab"
              onclick="changeBrowserUrl(this.href); return false;">
                <i class="i i--clock"></i>
                <span class="is-hidden--s i__text--right">#{messages['jsf.dashboard.activity.title']}</span>
            </a>
          </li>
          <s:fragment rendered="#{dashboardAction.getUserMaintainedProjectsCount() > 0}">
            <li>
              <a id="projects"
                href="#{request.contextPath}/dashboard/projects"
                class="js-tab"
                onclick="changeBrowserUrl(this.href); return false;">
                <i class="i i--project"></i>
                <span class="is-hidden--s i__text--right">#{messages['jsf.dashboard.projects.title']}</span>
              </a>
            </li>
          </s:fragment>
          <li class="tab__end">
            <a href="#{request.contextPath}/dashboard/settings"
              id="settings" class="js-tab"
              title="Account Settings"
              onclick="changeBrowserUrl(this.href); return false;">
                <span
                class="is-hidden--s i__text--left">#{messages['jsf.dashboard.settings.tab.title']}</span><i class="i i--settings"
                aria-hidden="true"></i>
            </a>
          </li>
        </ul>
      </nav>
      <div class="tabs__content panels__container l--push-top-1">
        <div id="activity_content" class="is-hidden">
          <ui:include src="../WEB-INF/layout/dashboard/activity.xhtml"/>
        </div>
        <div id="projects_content" class="is-hidden">
          <ui:include src="../WEB-INF/layout/dashboard/projects.xhtml"/>
        </div>
        <div id="settings_content" class="is-hidden">
          <ui:include src="../WEB-INF/layout/dashboard/settings.xhtml"/>
        </div>
      </div>
    </div>
    </div>
  </div>
</s:fragment>
</ui:define>
</ui:composition>
