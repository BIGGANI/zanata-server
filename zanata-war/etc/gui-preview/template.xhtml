<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<f:view contentType="text/html" xmlns="http://www.w3.org/1999/xhtml"
  xmlns:ui="http://java.sun.com/jsf/facelets"
  xmlns:h="http://java.sun.com/jsf/html"
  xmlns:f="http://java.sun.com/jsf/core"
  xmlns:a="http://richfaces.org/a4j"
  xmlns:s="http://jboss.com/products/seam/taglib"
  xmlns:rich="http://richfaces.org/rich"
  xmlns:a4j="http://richfaces.org/a4j">
<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<title>#{messages['jsf.ZanataMainTitle']}: <ui:insert name="page_title" /></title>
		<link rel="shortcut icon"
		  href="#{request.contextPath}/images/favicon.ico" type="image/x-icon" />
		<a:loadStyle src="/stylesheet/base.css" />
		<a:loadStyle src="/stylesheet/zanata.css" />
		<a:loadStyle src="/stylesheet/2.0.css" />
		<ui:insert name="head" />
	</head>

	<body>
		<div class="header">
			<div class="navBar">
				<ul>
					<li id="logoCol">
						<s:link view="/home.xhtml" propagation="none">
							<img src="#{requestContextPath}/images/logo2.png" alt="#{messages['jsf.ZanataMainDescription']}" class="logo" />
						</s:link>
					</li>
					<li id="translationCol">
						<a href="#">
						<img src="#{request.contextPath}/images/crystal_project/_16x16/apps/easymoblog.png" />Translation</a>
						<div class="submenu">
							<ul>
								<li>
									<s:link id="Projects" view="/project/home.xhtml" propagation="none">
										<img src="#{request.contextPath}/images/crystal_project/_16x16/apps/kllckety.png" />#{messages['jsf.Projects']}
									</s:link>
								</li>
								<li>
									<s:link id="version-groups" view="/version-group/home.xhtml" propagation="none">
										<img src="#{request.contextPath}/images/crystal_project/_16x16/apps/kdf.png" />#{messages['jsf.Groups']}
									</s:link>
								</li>
								<li>
									<s:link id="Languages" view="/language/home.xhtml" propagation="none">
										<img src="#{request.contextPath}/images/crystal_project/_16x16/apps/locale.png" />#{messages['jsf.Languages']}
									</s:link>
								</li>
							</ul>
						</div>
					</li>
					<li id="userCol">
						<s:fragment rendered="#{identity.loggedIn}">
							<a href="#"> 
								<h:graphicImage value="#{gravatarServiceImpl.getUserImageUrl(23)}" height="23" title="http://gravatar.com" class="avatar"/> 
								<span><h:outputText value="#{identity.username} " /></span>
							</a>
							<div class="submenu">
								<ul>
									<li>
										<s:link id="MyProfile" view="/profile/view.xhtml" propagation="none">
											<img src="#{request.contextPath}/images/crystal_project/_16x16/actions/kuser.png" />#{messages['jsf.MyProfile']}
										</s:link>
									</li>
									<li>
										<s:link id="Sign_out" view="/account/sign_out" value="#{messages['jsf.SignOut']}" propagation="none" />
									</li>
								</ul>
							</div>
						</s:fragment>
						<s:fragment rendered="#{not identity.loggedIn}">
                       		<s:link id="Sign_in" view="/account/sign_in?continue=#{urlUtil.getEncodedLocalUrl(request)}" value="#{messages['jsf.SignIn']}" propagation="none" />
						</s:fragment>
					</li>
					<li id="menuCol">
						<a href="#" class="text">&#9660;</a>
						<div class="submenu">
							<ul>
								<s:fragment rendered="#{not identity.loggedIn}">
									<li>
									   <s:link id="Register" view="/account/register.xhtml" value="#{messages['jsf.Register']}" propagation="none" rendered="#{applicationConfiguration.internalAuth}"/>
									   <s:fragment rendered="#{not applicationConfiguration.internalAuth}">
									       <a href="#{applicationConfiguration.registerPath}">#{messages['jsf.Register']}</a>
									   </s:fragment>
									</li>
								</s:fragment>
						
								<li>
									<s:link id="help" view="/help/view.xhtml" propagation="none">
										<img src="#{request.contextPath}/images/crystal_project/_16x16/actions/help.png" />#{messages['jsf.Help']}
									</s:link>
								</li>
								<s:fragment rendered="#{s:hasRole('admin')}">
									<li>
										<s:link id="Administration" view="/admin/home.xhtml" propagation="none">
											<img src="#{request.contextPath}/images/crystal_project/_16x16/actions/lin_agt_wrench.png" />#{messages['jsf.Administration']}
										</s:link>
									</li>
								</s:fragment>
							</ul>
						</div>
					</li>
				</ul>
				
				<div id="loading_top_right">
					<a:status>
					<f:facet name="start">
					<h:graphicImage value="/images/loading.gif" />
					</f:facet>
					</a:status>
				</div>
			</div>
		</div>
		
		<div id="container">
			<div id="bd">
				<div id="submenu"> 
			    	<ui:include src="search_panel.xhtml" />
			    </div>
				<div id="yui-main">
					<div class="yui-b">
						<a:outputPanel ajaxRendered="true">
						<h:messages id="messages" globalOnly="true" styleClass="message"
						errorClass="errormsg" infoClass="infomsg" warnClass="warnmsg"
						rendered="#{showGlobalMessages != 'false'}" />
						</a:outputPanel>
						<div id="main_body_content">
							<ui:insert name="center_content" />
						</div>
					</div>
				</div>
				<div class="yui-b">
        			<ui:insert name="right_content" />
				</div>
			</div>
		</div>
		
		<div class="footer">
				<div>
					#{messages['jsf.Copyright']} #{messages['jsf.CopyrightYearInfo']} 
					<a href="http://www.redhat.com/">#{messages['jsf.ManufacturerInfo']}</a> #{messages['jsf.AndOthers']}.
					#{messages['jsf.PoweredBy']} <a href="http://zanata.org/">#{messages['jsf.Zanata']}</a>.
					<br/>#{messages['jsf.RunningVersionInfo']}
				</div>
				
				<div id="localeSelector">
						<h:form id="localeSelector_form">
						<h:selectOneMenu id="Select"
						value="#{localeSelector.localeString}" valueChangeListener="#{localeSelector.select}" onchange="submit()" >
		                <f:selectItems value="#{localeSelector.supportedLocales}"/>
						</h:selectOneMenu>
						</h:form>
					</div>
			</div>
		<s:fragment rendered="#{not empty applicationConfiguration.piwikUrl and not empty applicationConfiguration.piwikIdSite}">
			<!-- Piwik --> <script type="text/javascript">
			var pkBaseURL = (("https:" == document.location.protocol) ? "https://#{applicationConfiguration.piwikUrl}/" : "http://#{applicationConfiguration.piwikUrl}/");
			document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
			</script><script type="text/javascript">
			try {
			var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", #{applicationConfiguration.piwikIdSite});
			var username =  "#{identity.username}";
			if(#{identity.loggedIn} == false)
			{
				username = "anonymous";
			} 
			piwikTracker.setCustomVariable (1, "Visit", username, "visit" ); 
			piwikTracker.setCustomVariable (2, "View page", username, "page" ); 
			
			piwikTracker.trackPageView();
			piwikTracker.enableLinkTracking();
			} catch( err ) {}
			</script>
			<!-- End Piwik Code -->
		</s:fragment>
	</body>
</html>
</f:view>